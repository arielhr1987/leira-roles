(()=>{"use strict";var i,e;window.jQuery,window.wp=window.wp||{},i=jQuery,e=window.wp,window.inlineEditUserCapabilities={init:function(){var e=this,t=i("#inline-edit-capabilities"),a=i("#the-list");e.type=a.attr("data-wp-lists").substring(5),e.what="#"+e.type+"-",a.on("click",".editinline_capabilities",function(){i(this).attr("aria-expanded","true"),inlineEditUserCapabilities.edit(this)}),t.keyup(function(i){if(27===i.which)return inlineEditUserCapabilities.revert()}),i(".cancel",t).click(function(){return inlineEditUserCapabilities.revert()}),i(".save",t).click(function(){return inlineEditUserCapabilities.save(this)}),i("input, select",t).keydown(function(e){if(13===e.which&&"capabilities_search_input"!==i(this).prop("name"))return inlineEditUserCapabilities.save(this)}),i('#posts-filter input[type="submit"]').mousedown(function(){e.revert()}),i(":checkbox.cb-capabilities-select-all",t).on("change",function(){var e=i(this);e.parents(".input-text-wrap").find(".capabilities-container :checkbox").not(e).prop("checked",e.is(":checked"))}),i('input[name="capabilities_search_input"]',t).on("keyup input",function(e){var t=i(this),a=t.val(),n=t.parents(".input-text-wrap").find(".capabilities-container");i(".notice",n).addClass("hidden"),n.find("> label.capability-item").each(function(e,t){var n;n=""===a.trim()||-1!==i(t).text().indexOf(a),i(this).toggleClass("hidden",!n)}),i("> label.capability-item:not(.hidden)",n).length||i(".notice",n).removeClass("hidden")}).on("keydown",function(i){if(13===i.which)return!1})},toggle:function(e){var t=this;"none"===i(t.what+t.getId(e)).css("display")?t.revert():t.edit(e)},edit:function(e){var t,a,n=this;return n.revert(),"object"==typeof e&&(e=n.getId(e)),t=i("#inline-edit-capabilities").clone(!0),a=i("#inline_capabilities_"+e),i("td",t).attr("colspan",i("th:visible, td:visible",".wp-list-table.widefat:first thead").length),i(n.what+e).hide().after(t).after('<tr class="hidden"></tr>'),i("> div",a).each(function(e,a){var n=(a=i(a)).attr("class");if(a=a.text(),"capabilities"===n){var s=i("div.capabilities-container",t),r=JSON.parse(a);i.each(r,function(i,e){var t='<label class="alignleft capability-item">';t+='<input type="checkbox" name="capability[]" value="'+i+'"'+(e?' checked="checked"':"")+">",t+='<span class="checkbox-title">'+i+"</span>",leiraRolesL10n[i]&&(t+='<i class="dashicons dashicons-editor-help leira-tooltip" title="'+leiraRolesL10n[i]+'"></i>'),t+="</label>",s.append(t)})}else i(":input[name="+n+"]",t).val(a)}),i(t).attr("id","edit-"+e).addClass("inline-editor").show(),i(".ptitle",t).eq(0).focus(),!1},save:function(t){var a;return"object"==typeof t&&(t=this.getId(t)),i("table.widefat .spinner").addClass("is-active"),a={action:"leira-roles-quick-edit-user-capabilities"},a=i("#edit-"+t).find(":input").serialize()+"&"+i.param(a),i.post(ajaxurl,a,function(a){var n,s,r=i("#edit-"+t+" .inline-edit-save .notice-error"),l=r.find(".error");i("table.widefat .spinner").removeClass("is-active"),a?-1!==a.indexOf("<tr")?(i(inlineEditUserCapabilities.what+t).siblings("tr.hidden").addBack().remove(),s=i(a).attr("id"),i("#edit-"+t).before(a).remove(),s?(s.replace(inlineEditUserCapabilities.type+"-",""),n=i("#"+s)):n=i(inlineEditUserCapabilities.what+t),n.hide().fadeIn(400,function(){n.find(".editinline_capabilities").attr("aria-expanded","false").focus(),e.a11y.speak(leiraRolesL10n.inlineEditSaved)})):(r.removeClass("hidden"),l.html(a),e.a11y.speak(l.text())):(r.removeClass("hidden"),l.html(leiraRolesL10n.inlineEditError),e.a11y.speak(leiraRolesL10n.inlineEditError))}),!1},revert:function(){var e=i("table.widefat tr.inline-editor").attr("id");e&&(i("table.widefat .spinner").removeClass("is-active"),i("#"+e).siblings("tr.hidden").addBack().remove(),e=e.substring(e.lastIndexOf("-")+1),i(this.what+e).show().find(".editinline_capabilities").attr("aria-expanded","false").focus())},getId:function(e){var t=("TR"===e.tagName?e.id:i(e).parents("tr").attr("id")).split("-");return t[t.length-1]}},i(document).ready(function(){inlineEditUserCapabilities.init()})})();